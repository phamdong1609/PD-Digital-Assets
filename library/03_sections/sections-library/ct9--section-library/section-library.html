<!-- 
  Section: QTDS Library (Phiên bản 3.6 - Fix lỗi build triệt để)
  Description: 
  - Thêm script bảo vệ để khởi tạo `locals` và các biến mặc định.
  - Cách này đảm bảo linh kiện không bị lỗi ReferenceError khi build tĩnh (CT9).
  - Sử dụng `||` để cung cấp giá trị mặc định cho các biến đơn giản.
-->
<script>
  expressions.locals = Object.assign({
    library_tagline: null,
    library_title_main: null,
    library_title_gradient: null,
    library_description: null,
    library_cta: null
  }, expressions.locals);
</script>
<section id="articles" class="qtds-section">
    <div class="qtds-container">
        <div class="qtds-scroll-animate qtds-section-header">
            <span class="qtds-section-header__tagline">
                {{ library_tagline || 'THƯ VIỆN TRI THỨC' }}
            </span>
            <h2>
                <if condition="typeof library_title_main !== 'undefined' || typeof library_title_gradient !== 'undefined'">
                    {{ library_title_main }} <span class="qtds-text-gradient">{{ library_title_gradient }}</span>
                </if>
                <if condition="typeof library_title_main === 'undefined' && typeof library_title_gradient === 'undefined'">
                    Khám Phá <span class="qtds-text-gradient">Kho Tàng Kiến Thức QTDS</span>
                </if>
            </h2>
            <p>
                {{ library_description || 'Tìm hiểu sâu hơn về chuyển đổi số, quản trị tín dụng và các giải pháp công nghệ qua bộ sưu tập nội dung được tuyển chọn kỹ lưỡng.' }}
            </p>
        </div>

        <!-- The grid will be populated by JavaScript, so it remains as is -->
        <div id="library-grid" class="qtds-library__grid"></div>
        <div id="library-loader" style="text-align: center; margin-top: var(--space-8);">Đang tải thư viện...</div>

        <div class="qtds-scroll-animate" style="text-align: center; margin-top: var(--space-12);">
             <!-- Dynamic CTA Button -->
            <if condition="typeof library_cta !== 'undefined'">
                <a href="{{ library_cta.href }}" target="_blank" rel="noopener noreferrer" class="qtds-btn qtds-btn--primary">
                    <i class="{{ library_cta.icon }}"></i>{{ library_cta.text }}
                </a>
            </if>
            <!-- Static Fallback CTA Button -->
            <if condition="typeof library_cta === 'undefined'">
                <a href="https://thuvien.qtds.vn" target="_blank" rel="noopener noreferrer" class="qtds-btn qtds-btn--primary">
                    <i class="fas fa-book-open"></i>Xem Toàn Bộ Thư Viện
                </a>
            </if>
        </div>
    </div>
</section>

